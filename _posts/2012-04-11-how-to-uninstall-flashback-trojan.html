---
title: "How to uninstall the Flashback Trojan"
layout: "post"
uuid: "2562940516813486159"
guid: "tag:blogger.com,1999:blog-4005196202633300179.post-2562940516813486159"
date: "2012-04-11 18:24:00"
updated: "2012-05-08 05:11:23"
description: 
blogger:
    siteid: "4005196202633300179"
    postid: "2562940516813486159"
categories: [Flashback malware, Tutorial, malware, trojan, Malware Removal]
author: 
    name: "Matthew Davies"
    url: "https://plus.google.com/100429834282733985044?rel=author"
    image: "//lh3.googleusercontent.com/-Yit-19gPheI/AAAAAAAAAAI/AAAAAAAABfI/xZBPozwlUV8/s512-c/photo.jpg"
---

<div class="css-full-post-content js-full-post-content">
  <div class="separator" style="clear: both; text-align: center;">
    <a href="http://4.bp.blogspot.com/-E2pmzgvviAI/T4XJB3NrR3I/AAAAAAAAAiY/kU2iE7qP4Jk/s1600/7ba3f3429920e4b42d3bb5663e221b9f.png" style="margin-left: 1em; margin-right: 1em;"><img height="236" src="http://4.bp.blogspot.com/-E2pmzgvviAI/T4XJB3NrR3I/AAAAAAAAAiY/kU2iE7qP4Jk/s320/7ba3f3429920e4b42d3bb5663e221b9f.png" width="320"></a>
  </div><br>
  &nbsp;The Flashback trojan is a Mac virus that now <a href="http://www.zdnet.com/blog/security/over-600000-macs-infected-with-flashback-trojan/11345" target="_blank">has control of over 600,000 Macs</a>. It poses as the Adobe Flash Player Updater and exploits a security hole in Java. It then steals all your user names and passwords for popular websites. Apple released a Java update that fixes the problem. Download <a href="http://support.apple.com/kb/DL1516" target="_blank">Java for Mac OS X 10.6 Update 7</a> (Snow Leopard users) or <a href="http://support.apple.com/kb/DL1515" target="_blank">Java for OS X Lion 2012-002</a>&nbsp;(Lion users). Both these links are to Apple KB articles that describe the update and allow you to download the installer package.<br>
  <br>
  Recently there was a question posted on <a href="http://apple.stackexchange.com/" target="_blank">Ask Different</a>&nbsp;asking <a href="http://apple.stackexchange.com/q/48130/7833" target="_blank">Is my Mac infected with the Flashback trojan?</a>&nbsp;I posted <a href="http://apple.stackexchange.com/a/48134/7833" target="_blank">an answer to the question</a>, which was voted up quite a bit and was accepted by the asker. Here are <a href="http://www.f-secure.com/v-descs/trojan-downloader_osx_flashback_i.shtml" target="_blank">instructions from F-Secure</a> on how to check for the Flashback trojan, and remove it:<br>

  <ol>
    <li>Run the following command in Terminal (Applications&gt; Utilities &gt;Terminal<br>
    <br>
    <code style="background: white; color: black; margin: 2px; padding: 5px;">defaults read /Applications/Safari.app/Contents/Info LSEnvironment</code><br></li>

    <li>Take note of the value <code style="background: white; color: black; margin: 2px; padding: 5px;">DYLD_INSERT_LIBRARIES</code></li>

    <li>Proceed to step 8 if you got the following error message:<br>
    <br>
    <code style="background: white; color: black; margin: 2px; padding: 5px;">The domain/default pair of (/Applications/Safari.app/Contents/Info, LSEnvironment) does not exist</code><br></li>

    <li>Otherwise, run the following command in Terminal:<br>
    <br>
    <code style="background: white; color: black; margin: 2px; padding: 5px;">grep -a -o '__ldpath__[ -~]*' %path_obtained_in_step2%</code><br>
    <br></li>

    <li>Take note of the value after <code style="background: white; color: black; margin: 2px; padding: 5px;">"__ldpath__"</code><br></li>

    <li>Run the following commands in Terminal (first make sure there is only one entry from step 2):<br>
    <br>
    <code style="background: white; color: black; margin: 2px; padding: 5px;">sudo defaults delete /Applications/Safari.app/Contents/Info LSEnvironment<br>
    <br>
    sudo chmod 644 /Applications/Safari.app/Contents/Info.plist</code><br></li>

    <li>Delete the files obtained in steps 2 and 5.</li>

    <li>Run the following command in Terminal:<br>
    <br>
    <code style="background: white; color: black; margin: 2px; padding: 5px;">defaults read ~/.MacOSX/environment DYLD_INSERT_LIBRARIES</code><br></li>

    <li>Take note of the result. Your system is already clean of this variant if you got an error message similar to the following:<br>
    <br>
    <code style="background: white; color: black; margin: 2px; padding: 5px;">"The domain/default pair of (/Users/joe/.MacOSX/environment, DYLD_INSERT_LIBRARIES) does not exist"</code><br></li>

    <li>Otherwise, run the following command in Terminal:<br>
    <br>
    <code style="background: white; color: black; margin: 2px; padding: 5px;">grep -a -o '__ldpath__[ -~]*' %path_obtained_in_step9%</code><br></li>

    <li>Take note of the value after <code style="background: white; color: black; margin: 2px; padding: 5px;">"__ldpath__"</code><br></li>

    <li>Run the following commands in Terminal:<br>
    <br>
    <code style="background: white; color: black; margin: 2px; padding: 5px;">defaults delete ~/.MacOSX/environment DYLD_INSERT_LIBRARIES<br>
    <br>
    launchctl unsetenv DYLD_INSERT_LIBRARIES</code></li>

    <li>Finally, delete the files obtained in steps 9 and 11.</li>
  </ol>

  <div>
    An alternative to the Terminal method is <a href="https://github.com/jils/FlashbackChecker/wiki" rel="nofollow" target="_blank">Flashback Checker</a>. It is a free little application that checks for the trojan and tell you whether you are infected or not.
  </div>
</div>